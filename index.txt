<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Red de Salud del Oriente E.S.E ‚Äì Juego de Socializaci√≥n del Procedimiento de ASIGNACI√ìN Y CONFIRMACI√ìN DE CITAS</title>
  <style>
    :root{--bg:#f3f7ff;--primary:#3b82f6;--primary-600:#2563eb;--accent:#22c55e;--warn:#f59e0b;--danger:#ef4444;--card:#ffffff;--muted:#6b7280;--pastel1:#c7d2fe;--pastel2:#fde68a;--pastel3:#a7f3d0;--pastel4:#fecaca}
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial;background:linear-gradient(180deg,var(--bg),#fff 60%);color:#111827}
    header{position:sticky;top:0;z-index:10;backdrop-filter:blur(6px);background:rgba(243,247,255,.8);border-bottom:1px solid #e5e7eb}
    .wrap{max-width:1100px;margin:auto;padding:16px}
    .hero{display:flex;flex-direction:column;gap:8px;align-items:flex-start;flex-wrap:wrap}
    h1{margin:0;font-size:clamp(1.4rem,2.8vw,2rem);font-weight:800}
    h2.header-sub{margin:0;font-size:1rem;font-weight:700;color:#1e3a8a}
    .badge{display:inline-flex;align-items:center;gap:8px;background:var(--pastel1);color:#1f2937;padding:6px 10px;border-radius:999px;font-weight:600}
    .grid{display:grid;gap:16px}
    @media(min-width:860px){.grid-2{grid-template-columns:repeat(2,1fr)}}
    .card{background:var(--card);border:1px solid #e5e7eb;border-radius:16px;padding:16px;box-shadow:0 8px 24px rgba(17,24,39,.05)}
    button{appearance:none;border:none;background:var(--primary);color:#fff;padding:10px 14px;border-radius:12px;font-weight:700;cursor:pointer;text-align:left}
    button:hover{background:var(--primary-600)}
    .btn-ghost{background:#eef2ff;color:#1e40af}
    .btn-success{background:var(--accent)}
    .btn-warn{background:var(--warn)}
    input,select,textarea{width:100%;padding:10px 12px;border-radius:12px;border:1px solid #e5e7eb}
    .row{display:flex;gap:10px;flex-wrap:wrap}
    .chip{display:inline-flex;align-items:center;gap:8px;padding:6px 10px;background:var(--pastel3);border-radius:999px;font-weight:600;margin:4px 6px 0 0}
    .hidden{display:none!important}
    .title{font-weight:800;font-size:1.2rem}
    .subtitle{font-weight:700;color:#1f2937}
    .progress{height:10px;background:#e5e7eb;border-radius:999px;overflow:hidden}
    .progress>div{height:100%;width:0%;background:linear-gradient(90deg,var(--primary),#60a5fa)}
    .kpi{display:grid;grid-template-columns:1fr auto;gap:8px;align-items:center;padding:10px 12px;border-radius:12px;border:1px dashed #cbd5e1;background:#f8fafc}
    .kpi strong{font-size:1.1rem}
    .pill{padding:.25rem .6rem;border-radius:999px;font-weight:700}
    .pill.ok{background:#dcfce7;color:#166534}
    .pill.warn{background:#fff7ed;color:#9a3412}
    .pill.err{background:#fee2e2;color:#991b1b}
    .small{font-size:.9rem}
    .list{display:grid;gap:8px}
    .list li{background:#f9fafb;border:1px solid #e5e7eb;border-radius:12px;padding:10px 12px}
    .option-block{border:1px solid #e5e7eb;border-radius:12px;padding:6px;box-shadow:0 2px 6px rgba(0,0,0,.05);background:#fff;width:100%}
  </style>
</head>
<body>
  <header>
    <div class="wrap hero">
      <h2 class="header-sub">Red de Salud del Oriente E.S.E</h2>
      <div class="row" style="align-items:center; gap:8px">
        <span class="badge">üéØ Misi√≥n Citas</span>
        <h1>Juego de Socializaci√≥n del Procedimiento de ASIGNACI√ìN Y CONFIRMACI√ìN DE CITAS</h1>
      </div>
      <div class="row" id="scoreHeader" style="margin-top:8px">
        <div class="chip">‚úîÔ∏è Correctas: <span id="hdrCorrect">0</span></div>
        <div class="chip" style="background:var(--pastel2)">‚è≥ Tiempo: <span id="hdrTime">0:00</span></div>
        <div class="chip" style="background:var(--pastel4)">‚≠ê Puntaje: <span id="hdrScore">0</span></div>
        <button id="runTests" class="btn-ghost">üß™ Pruebas</button>
      </div>
    </div>
  </header>

  <main class="wrap" style="padding-block:18px">
    <!-- 1) Registro visible por defecto -->
    <section class="card" id="setup">
      <h2 class="title">1) Registro del participante</h2>
      <p class="small">Ingresa tus datos. Esta sesi√≥n es <b>individual</b> y tus resultados <b>no ser√°n visibles</b> para otras personas.</p>
      <div class="grid grid-2">
        <div class="card" style="padding:12px">
          <h3 class="subtitle">Tus datos</h3>
          <div class="row">
            <input id="playerName" placeholder="Nombre completo" />
            <input id="playerIPS" placeholder="IPS donde laboras" />
            <select id="playerRole">
              <option value="">Rol‚Ä¶</option>
              <option>Facturador</option>
              <option>Asistencial</option>
              <option>Administrativo</option>
              <option>Servicios Generales</option>
              <option>Seguridad</option>
            </select>
          </div>
          <p class="small muted" style="margin-top:8px">Esta informaci√≥n solo se usa para tu constancia y el resumen que puedes enviarte por correo desde este dispositivo.</p>
        </div>
        <div class="card" style="padding:12px">
          <h3 class="subtitle">Par√°metros</h3>
          <label class="small">Tiempo por pregunta (segundos)</label>
          <input type="number" id="qTime" min="10" max="120" value="30" />
          <label class="small" style="margin-top:8px; display:block">N√∫mero de preguntas (quiz)</label>
          <input type="number" id="qCount" min="5" max="20" value="10" />
          <label class="small" style="margin-top:8px; display:block">Casos simulados</label>
          <input type="number" id="caseCount" min="1" max="10" value="3" />
        </div>
      </div>
      <div class="footer row">
        <button id="startGame" style="text-align:center">Iniciar ‚ñ∂</button>
      </div>
    </section>

    <!-- 2) Quiz -->
    <section class="card hidden" id="quiz">
      <div class="row" style="align-items:center; gap:14px">
        <h2 class="title">2) Ronda de preguntas</h2>
        <span class="pill ok" id="quizStatus">Listo</span>
        <div class="row" style="align-items:center; gap:10px; margin-left:auto">
          <div class="progress" style="width:220px"><div id="qProgress"></div></div>
          <span class="muted small">Pregunta <b id="qIndex">0</b>/<b id="qTotal">0</b></span>
        </div>
      </div>
      <div id="quizBody" style="margin-top:10px"></div>
      <div class="footer row">
        <button id="nextQ" class="btn-success">Siguiente ‚ñ∂</button>
        <button id="skipQ" class="btn-ghost">Saltar</button>
      </div>
    </section>

    <!-- 3) Simulaci√≥n -->
    <section class="card hidden" id="sim">
      <div class="row" style="align-items:center; gap:14px">
        <h2 class="title">3) Simulaci√≥n pr√°ctica</h2>
        <span class="pill warn" id="simStatus">Pendiente</span>
        <div class="row" style="margin-left:auto"><span class="muted small">Caso <b id="cIndex">0</b>/<b id="cTotal">0</b></span></div>
      </div>
      <div id="simBody" style="margin-top:10px"></div>
      <div class="footer row">
        <button id="nextC" class="btn-success">Siguiente caso ‚ñ∂</button>
        <button id="finish" class="btn-warn" style="margin-left:auto">Finalizar juego</button>
      </div>
    </section>

    <!-- 4) Resultados -->
    <section class="card hidden" id="results">
      <h2 class="title">4) Resultados y adherencia</h2>
      <div class="grid" style="grid-template-columns:1fr 1fr; gap:16px">
        <div class="kpi"><div>
          <div class="small muted">Puntaje total</div>
          <strong id="resScore">0</strong>
        </div><span class="pill ok" id="resScoreTag">Excelente</span></div>
        <div class="kpi"><div>
          <div class="small muted">Adherencia simulaci√≥n</div>
          <strong id="resAdh">0%</strong>
        </div><span class="pill warn" id="resAdhTag">A mejorar</span></div>
      </div>
      <div class="card" style="margin-top:12px">
        <h3 class="subtitle">Participante</h3>
        <ul id="resParticipants" class="list"></ul>
      </div>
      <div class="card" style="margin-top:12px">
        <h3 class="subtitle">Detalle</h3>
        <ul id="detail" class="list"></ul>
      </div>
      <div class="footer row">
        <button id="sendEmail">Enviar resultados por correo</button>
        <button id="exportCSV">Exportar CSV</button>
        <button class="btn-ghost" id="restart">Reiniciar</button>
      </div>
      <div class="small muted" id="sendStatus"></div>
    </section>
  </main>

<script>
/*************** Config general ***************/
var DEST_EMAIL = 'diegocortes24@gmail.com';
var PROCEDIMIENTO_VERSION = 'v1.0';

/*************** Datos ***************/
var questionBank = [
  {prompt:"Al recibir la solicitud de cita, ¬øcu√°l es el primer paso seg√∫n el procedimiento?",options:["Verificar identidad del paciente (tipo y n√∫mero de documento)","Confirmar disponibilidad del especialista","Solicitar orden m√©dica","Emitir recordatorio por SMS"],answer:0,ref:"Secci√≥n 1: Verificaci√≥n de identidad"},
  {prompt:"¬øQu√© dato es obligatorio registrar en el sistema al momento de asignar la cita?",options:["Color favorito del paciente","Centro de costo","Tel√©fono de contacto actualizado","Nombre del profesional tratante anterior"],answer:2,ref:"Secci√≥n 2: Datos m√≠nimos de registro"},
  {prompt:"En caso de cita prioritaria, el flujo correcto es:",options:["Agendar en la primera disponibilidad sin validaciones","Escalar a enfermer√≠a/triage, validar criterios y asignar seg√∫n ruta prioritaria","Reagendar autom√°ticamente para la siguiente semana","Derivar a urgencias sin registro"],answer:1,ref:"Secci√≥n 3: Manejo de prioridades"},
  {prompt:"Para reprogramaciones por parte del paciente, se debe:",options:["Eliminar la cita anterior sin dejar trazabilidad","Registrar motivo, reprogramar y conservar historial de cambios","Cobrar multa autom√°ticamente","Asignar otra cita sin verificar disponibilidad"],answer:1,ref:"Secci√≥n 4: Reprogramaciones y cancelaciones"},
  {prompt:"Los canales oficiales para asignaci√≥n de citas son:",options:["Telefon√≠a, caja (facturaci√≥n), app/web institucional","Redes sociales personales del funcionario","Mensajes de voz de WhatsApp no institucional","Contacto directo con el profesional"],answer:0,ref:"Secci√≥n 5: Canales autorizados"},
  {prompt:"Antes de cerrar la asignaci√≥n, es obligatorio:",options:["Ofrecer encuesta de satisfacci√≥n","Confirmar datos, fecha/hora, profesional, sede y medio de recordatorio","Imprimir ticket f√≠sico","Pedir referencia personal"],answer:1,ref:"Secci√≥n 6: Cierre y confirmaci√≥n"}
];

var caseBank = [
  {title:"Paciente nuevo con orden v√°lida y tel√©fono desactualizado",scenario:"Mar√≠a P. solicita cita de medicina general. Trae orden vigente. Su tel√©fono cambi√≥ recientemente.",checklist:["Verifica identidad con tipo y n√∫mero de documento","Actualiza datos de contacto (tel√©fono y correo)","Valida vigencia de la orden y restricciones","Registra canal de origen de la solicitud","Asigna cita y confirma fecha/hora/profesional/sede","Registra consentimiento de recordatorio (SMS/email)"]},
  {title:"Prioridad cl√≠nica por s√≠ntoma de alarma",scenario:"Carlos R. reporta dolor tor√°cico s√∫bito. Solicita cita prioritaria.",checklist:["Aplica protocolo de prioridad y escala a enfermer√≠a/triage","Eval√∫a criterios de ruta prioritaria","Evita cierre sin valoraci√≥n prioritaria","Registra trazabilidad del caso en el sistema","Asigna seg√∫n disponibilidad prioritaria si procede"]},
  {title:"Reprogramaci√≥n por fuerza mayor",scenario:"Luc√≠a A. no podr√° asistir ma√±ana por hospitalizaci√≥n de familiar. Solicita reprogramaci√≥n.",checklist:["Verifica identidad del paciente","Registra motivo de reprogramaci√≥n","Reprograma manteniendo historial de cambios","Env√≠a nueva confirmaci√≥n de cita","Evita duplicidad de citas para el mismo servicio"]}
];

/*************** Estado ***************/
var state = { participant:null, qTime:30, qCount:10, caseCount:3, currentQ:0, currentC:0, score:0, correct:0, answers:[], casesResults:[], timer:null, timeLeft:0, startedAt:null };

/*************** Utils ***************/
function $(s){return document.querySelector(s)}
function el(tag, attrs, children){ attrs=attrs||{}; children=children||[]; var n=document.createElement(tag); for(var k in attrs){ if(k==='class') n.className=attrs[k]; else if(k==='html') n.innerHTML=attrs[k]; else n.setAttribute(k, attrs[k]); } for(var i=0;i<children.length;i++){ n.appendChild(children[i]); } return n; }
function fmtTime(s){ var m=Math.floor(s/60), r=(s%60).toString().padStart(2,'0'); return m+":"+r; }
function shuffle(a){ return a.map(function(x){return [Math.random(),x]}).sort(function(a,b){return a[0]-b[0]}).map(function(x){return x[1]}); }
function updateHeader(){ $('#hdrScore').textContent=state.score; $('#hdrCorrect').textContent=state.correct; }

/*************** Registro ***************/
function validateParticipant(){
  var name=$('#playerName').value.trim();
  var ips=$('#playerIPS').value.trim();
  var role=$('#playerRole').value.trim();
  if(!name||!ips||!role){ alert('Completa Nombre, IPS y Rol.'); return false; }
  state.participant={name:name, ips:ips, role:role};
  return true;
}

$('#startGame').addEventListener('click', function(){
  if(!validateParticipant()) return;
  state.qTime=Math.max(10, parseInt($('#qTime').value||30,10));
  state.qCount=Math.max(5, Math.min(20, parseInt($('#qCount').value||10,10)));
  state.caseCount=Math.max(1, Math.min(10, parseInt($('#caseCount').value||3,10)));
  setupQuiz(); $('#setup').classList.add('hidden'); $('#quiz').classList.remove('hidden'); state.startedAt=new Date(); tickStopwatch(); updateHeader();
});

/*************** Quiz ***************/
var quizQuestions=[]; var selected=null; var locked=false;
function setupQuiz(){ quizQuestions=shuffle(questionBank.slice()).slice(0,state.qCount); state.currentQ=0; state.score=0; state.correct=0; state.answers=[]; $('#qTotal').textContent=quizQuestions.length; renderQuestion(); }
function renderQuestion(){
  var idx=state.currentQ, q=quizQuestions[idx];
  document.getElementById('qIndex').textContent=idx+1;
  var body=document.getElementById('quizBody');
  body.innerHTML='';
  if(state.timer) clearInterval(state.timer);
  state.timeLeft=state.qTime;
  document.getElementById('quizStatus').textContent='Tiempo: '+state.timeLeft+'s';
  state.timer=setInterval(function(){
    state.timeLeft--; document.getElementById('quizStatus').textContent='Tiempo: '+state.timeLeft+'s';
    if(state.timeLeft<=0){ clearInterval(state.timer); lockQuestion(); }
  },1000);
  var prompt=el('div',{class:'subtitle',html:q.prompt});
  var opts=el('div',{class:'grid',style:'grid-template-columns:1fr 1fr; gap:10px'});
  q.options.forEach(function(opt,i){
    var row=el('div',{class:'option-block'});
    var btn=el('button',{class:'btn-ghost',html:opt,style:'flex:1; text-align:left; padding:10px'});
    btn.addEventListener('click',function(){ selectOption(i); });
    row.appendChild(btn);
    opts.appendChild(row);
  });
  body.appendChild(prompt);
  body.appendChild(opts);
  updateProgress();
}
function selectOption(i){ if(locked) return; selected=i; lockQuestion(); }
function lockQuestion(){ if(locked) return; locked=true; clearInterval(state.timer); var q=quizQuestions[state.currentQ]; var buttons=Array.prototype.slice.call($('#quizBody').querySelectorAll('button')); buttons.forEach(function(b,i){ b.disabled=true; if(i===q.answer){ b.style.background='var(--accent)'; b.style.color='#064e3b'; } if(selected!==null && i===selected && selected!==q.answer){ b.style.background='var(--danger)'; } }); var correct=selected===q.answer; state.answers.push({index:state.currentQ+1, correct:correct, selected:selected, answer:q.answer, ref:q.ref}); if(correct){ state.score+=10; state.correct+=1; updateHeader(); } $('#quizStatus').textContent= correct ? '‚úÖ Correcto (+10)' : '‚ùå Incorrecto'; }
function updateProgress(){ var pct=(state.currentQ/quizQuestions.length)*100; $('#qProgress').style.width=pct+'%'; }
$('#nextQ').addEventListener('click', function(){ if(state.currentQ<quizQuestions.length-1){ state.currentQ++; locked=false; selected=null; renderQuestion(); } else { $('#quiz').classList.add('hidden'); setupSim(); $('#sim').classList.remove('hidden'); } });
$('#skipQ').addEventListener('click', function(){ if(locked) return; selected=null; lockQuestion(); });

/*************** Simulaci√≥n ***************/
var simCases=[];
function setupSim(){ simCases=shuffle(caseBank.slice()).slice(0,state.caseCount); state.currentC=0; state.casesResults=[]; $('#cTotal').textContent=simCases.length; renderCase(); }
function renderCase(){
  document.getElementById('cIndex').textContent=state.currentC+1;
  var c=simCases[state.currentC];
  document.getElementById('simStatus').textContent='En curso';
  var body=document.getElementById('simBody');
  body.innerHTML='';
  var head=el('div',{class:'subtitle',html:'<b>'+c.title+'</b>'});
  var scen=el('p',{class:'small',html:c.scenario});
  var list=el('div');
  c.checklist.forEach(function(item){
    var row=el('div',{class:'option-block',style:'margin:6px 0'});
    var inner=el('label',{class:'row',style:'align-items:center; gap:10px'});
    var cb=el('input',{type:'checkbox'});
    inner.appendChild(cb);
    inner.appendChild(el('span',{class:'small',html:item}));
    row.appendChild(inner);
    list.appendChild(row);
  });
  var note=el('textarea',{placeholder:'Observaciones'});
  note.rows=3;
  body.appendChild(head);
  body.appendChild(scen);
  body.appendChild(list);
  body.appendChild(note);
}
function evaluateCase(){ var c=simCases[state.currentC]; var checks=Array.prototype.slice.call($('#simBody').querySelectorAll('input[type="checkbox"]')); var total=checks.length, done=checks.filter(function(x){return x.checked}).length; var adherence=Math.round((done/total)*100); var bonus=0; if(adherence===100) bonus=15; else if(adherence>=80) bonus=8; else if(adherence>=60) bonus=4; state.score+=bonus; updateHeader(); var noteEl=$('#simBody').querySelector('textarea'); var note=(noteEl && noteEl.value) ? noteEl.value : ''; state.casesResults.push({caseIndex:state.currentC+1,title:c.title,adherence:adherence,bonus:bonus,note:note}); }
$('#nextC').addEventListener('click', function(){ evaluateCase(); if(state.currentC<simCases.length-1){ state.currentC++; renderCase(); } else { $('#simStatus').textContent='Completado'; $('#sim').classList.add('hidden'); renderResults(); $('#results').classList.remove('hidden'); } });
$('#finish').addEventListener('click', function(){ evaluateCase(); $('#sim').classList.add('hidden'); renderResults(); $('#results').classList.remove('hidden'); });

/*************** Resultados ***************/
function renderResults(){ var totalAdh=Math.round(state.casesResults.reduce(function(a,c){return a+c.adherence},0)/(state.casesResults.length||1)); $('#resScore').textContent=state.score; $('#resAdh').textContent=totalAdh+'%'; $('#resScoreTag').textContent= state.score>=(state.qCount*6)?'Excelente':(state.score>=(state.qCount*4)?'Bueno':'A mejorar'); $('#resAdhTag').textContent= totalAdh>=90?'Excelente':(totalAdh>=75?'Bueno':'A mejorar'); var ulp=$('#resParticipants'); ulp.innerHTML=''; if(state.participant){ ulp.appendChild(el('li',{html:'#1 ¬∑ <b>'+state.participant.name+'</b> ‚Äî IPS: '+state.participant.ips+' ‚Äî Rol: '+state.participant.role})); } var ul=$('#detail'); ul.innerHTML=''; state.answers.forEach(function(a){ ul.appendChild(el('li',{html:'Pregunta '+a.index+': <b>'+(a.correct?'Correcta':'Incorrecta')+'</b> ¬∑ Ref: '+a.ref})); }); state.casesResults.forEach(function(c){ ul.appendChild(el('li',{html:'Caso '+c.caseIndex+' ‚Äì <b>'+c.title+'</b>: Adherencia '+c.adherence+'% ¬∑ Bonus +'+c.bonus+(c.note? ' ¬∑ Nota: '+c.note:'')})); }); }

function buildEmailBody(){ var adh=Math.round(state.casesResults.reduce(function(a,c){return a+c.adherence},0)/(state.casesResults.length||1)); var participante= state.participant? (state.participant.name+' (IPS: '+state.participant.ips+', Rol: '+state.participant.role+')') : ''; var resumen='Puntaje total: '+state.score+'%0AAdherencia promedio: '+adh+'%25%0AParticipante: '+participante; return 'Procedimiento: '+encodeURIComponent(PROCEDIMIENTO_VERSION)+'%0A'+resumen; }

$('#exportCSV').addEventListener('click', function(){ var rows=[]; rows.push(['Misi√≥n Citas','Procedimiento',PROCEDIMIENTO_VERSION]); if(state.participant) rows.push(['Participante', state.participant.name+' (IPS: '+state.participant.ips+', Rol: '+state.participant.role+')']); rows.push([]); rows.push(['#','Tipo','Etiqueta','Valor']); rows.push([1,'Score','Puntaje total',state.score]); var totalAdh=Math.round(state.casesResults.reduce(function(a,c){return a+c.adherence},0)/(state.casesResults.length||1)); rows.push([2,'Adherencia','Promedio', totalAdh+'%']); rows.push([]); rows.push(['Detalle Quiz']); rows.push(['Pregunta','Correcta','Ref']); state.answers.forEach(function(a){ rows.push([a.index, a.correct?'S√≠':'No', a.ref]); }); rows.push([]); rows.push(['Detalle Casos']); rows.push(['Caso','T√≠tulo','Adherencia %','Bonus','Nota']); state.casesResults.forEach(function(c){ rows.push([c.caseIndex,c.title,c.adherence,c.bonus,c.note]); }); var csv=rows.map(function(r){return r.map(function(v){return '"'+String(v==null? '': v).replace(/"/g,'""')+'"'}).join(',')}).join('\n'); var blob=new Blob([csv],{type:'text/csv;charset=utf-8;'}); var url=URL.createObjectURL(blob); var a=document.createElement('a'); a.href=url; a.download='mision_citas_resultados_'+new Date().toISOString().slice(0,10)+'.csv'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url); });

$('#sendEmail').addEventListener('click', function(){ var subject=encodeURIComponent('Resultados Misi√≥n Citas'); var body=buildEmailBody(); var mailto='mailto:'+DEST_EMAIL+'?subject='+subject+'&body='+body; window.location.href=mailto; $('#sendStatus').textContent='‚úâÔ∏è Se abri√≥ tu cliente de correo con los datos. (Puedes adjuntar el CSV si lo exportaste).'; });

$('#restart').addEventListener('click', function(){ location.reload(); });

/*************** Cron√≥metro ***************/
function tickStopwatch(){ var start=state.startedAt||new Date(); function raf(){ var s=Math.floor((Date.now()-start)/1000); document.getElementById('hdrTime').textContent=fmtTime(s); requestAnimationFrame(raf);} requestAnimationFrame(raf);} 

/*************** Pruebas ***************/
function runSelfTests(){ var results=[]; function expect(name,cond){results.push({name:name,ok:!!cond})}
  // T1: no inicia sin datos
  $('#playerName').value=''; $('#playerIPS').value=''; $('#playerRole').value='';
  document.getElementById('startGame').click();
  expect('No inicia sin datos', !state.participant);
  // T2: inicia con datos v√°lidos
  $('#playerName').value='Ana Prueba'; $('#playerIPS').value='IPS Norte'; $('#playerRole').value='Facturador';
  document.getElementById('startGame').click();
  expect('Crea participante v√°lido', !!state.participant && state.participant.name==='Ana Prueba');
  // T3: setupQuiz respeta qCount
  state.qCount=5; setupQuiz(); expect('setupQuiz usa qCount', document.getElementById('qTotal').textContent==='5');
  // T4: skip cuenta incorrecto
  selected=null; locked=false; lockQuestion(); expect('Skip es incorrecto', state.answers[state.answers.length-1].correct===false);
  alert('Resultados de pruebas:\n'+results.map(function(r){return (r.ok?'‚úÖ':'‚ùå')+' '+r.name}).join('\n'));
}

document.getElementById('runTests').addEventListener('click', runSelfTests);

// Inicializar encabezado al cargar (registro visible)
updateHeader();
</script>
</body>
</html>
